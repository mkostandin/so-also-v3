# Feature Plan: 0030 - Horizontal Scrollable Event Filters

## Overview
Replace the current multi-row pill-style event type filters with a compact, horizontally scrollable single-line component to reduce vertical space usage while maintaining consistent filter state across map, list, and calendar views.

## Current Implementation Analysis

### EventTypeFilter Component (`ui/src/components/EventTypeFilter.tsx`)
- Uses `flex flex-wrap gap-2` layout creating multiple rows when buttons overflow
- Pill-style buttons with `rounded-full` and responsive scaling
- Vertical container with `flex-col gap-3 p-4` taking significant space
- State managed through FilterContext for persistence across views

### View Integration
- **MapView**: Filter positioned above map in `max-w-3xl` container
- **ListView**: Filter at top with `space-y-3` spacing
- **CalendarView**: Filter positioned with `space-y-4` spacing above calendar grid

### Space Usage Issues
- Multi-row layout consumes excessive vertical space on narrow screens
- Fixed padding and margins around filter container
- Vertical stacking with other UI elements reduces content area

## Technical Requirements

### Core Component Changes
1. **Replace flex-wrap with horizontal scroll container**
   - Use `overflow-x-auto` for horizontal scrolling
   - Maintain single row layout with `flex-nowrap`
   - Preserve existing button styling and interactions

2. **Optimize container spacing**
   - Reduce vertical padding from `p-4` to minimal value
   - Remove `flex-col gap-3` wrapper structure
   - Use `flex` container for horizontal layout

3. **Maintain responsive behavior**
   - Ensure horizontal scrolling works on mobile devices
   - Preserve touch interactions and accessibility
   - Test button sizing and spacing on various screen sizes

### View-Specific Updates
1. **MapView (`ui/src/routes/MapView.tsx`)**
   - Update filter container layout
   - Ensure proper integration with map component
   - Maintain existing responsive breakpoints

2. **ListView (`ui/src/routes/ListView.tsx`)**
   - Adjust spacing between filter and event list
   - Preserve location permission banner positioning
   - Maintain `max-w-3xl` container constraints

3. **CalendarView (`ui/src/routes/CalendarView.tsx`)**
   - Update filter positioning above calendar grid
   - Ensure compatibility with distance filter component
   - Preserve `max-w-4xl` container layout

### State Management Preservation
- **FilterContext**: Maintain existing context structure unchanged
- **State Persistence**: Ensure filter selections persist across view changes
- **Real-time Updates**: Preserve immediate filter application without reloads
- **Cross-View Consistency**: Keep synchronized filtering across all three views

## Implementation Phases

### Phase 1: Core Filter Component Refactor
1. **Update EventTypeFilter.tsx**
   - Replace `flex flex-wrap` with `flex overflow-x-auto`
   - Remove vertical container structure
   - Optimize button spacing for horizontal layout
   - Add scroll indicators for better UX

2. **CSS Optimizations**
   - Implement smooth scrolling behavior
   - Add scroll snap for better button alignment
   - Preserve existing hover and focus states
   - Ensure proper scrollbar styling

### Phase 2: View Integration Updates
1. **MapView Integration**
   - Update container structure to accommodate horizontal filter
   - Adjust spacing between filter and map component
   - Test responsive behavior on various screen sizes

2. **ListView Integration**
   - Modify filter container layout
   - Preserve integration with location permission banner
   - Ensure proper spacing with event list content

3. **CalendarView Integration**
   - Update filter positioning above calendar
   - Maintain compatibility with distance filter
   - Preserve responsive grid layout

### Phase 3: Testing & Polish
1. **Cross-Device Testing**
   - Test horizontal scrolling on mobile devices
   - Verify touch interactions and accessibility
   - Check responsive behavior across breakpoints

2. **UX Refinement**
   - Add visual scroll indicators if needed
   - Optimize button spacing for horizontal layout
   - Ensure smooth scrolling performance

## Files to Modify

### Core Components
- `ui/src/components/EventTypeFilter.tsx` - Main filter component refactor
- `ui/src/routes/MapView.tsx` - Map view filter integration
- `ui/src/routes/ListView.tsx` - List view filter integration
- `ui/src/routes/CalendarView.tsx` - Calendar view filter integration

### Related Components
- `ui/src/routes/MapIndex.tsx` - Filter context provider (no changes needed)
- `ui/src/components/DistanceFilter.tsx` - Ensure compatibility (CalendarView)

## Technical Considerations

### Performance
- Horizontal scrolling should be lightweight and smooth
- Preserve existing button interaction performance
- Maintain real-time filter updates without performance degradation

### Accessibility
- Ensure horizontal scrolling is accessible via keyboard navigation
- Preserve existing ARIA labels and focus management
- Test screen reader compatibility with scrollable container

### Browser Compatibility
- Verify horizontal scroll behavior across different browsers
- Ensure touch scrolling works properly on mobile devices
- Test scrollbar styling and behavior

## Additional Requirements (Update)

### Layout Consistency
- [x] Remove padding gaps from ListView and CalendarView to match MapView
- [x] Ensure consistent spacing and positioning across all three views

### Scroll Position Persistence
- [x] Save horizontal scroll position when switching between views
- [x] Restore scroll position when returning to a previously visited view
- [x] Add scroll position state to FilterContext for persistence
- [x] Truly instant scroll position restoration without any animation or jarring effects
- [x] Maintain scroll position seamlessly across view switches using requestAnimationFrame

### Visual Polish
- [x] Removed scroll indicators for cleaner, minimal appearance
- [x] Removed focus outlines from filter pills for cleaner appearance
- [x] Clean filter interface without visual distractions

## Success Criteria
- [x] Filter component uses single horizontal line with scrolling
- [x] Vertical space usage reduced by 40-60% compared to current implementation
- [x] Filter state persists seamlessly across all three views
- [x] No abrupt reloading when switching between views
- [x] Responsive behavior maintained across all device sizes
- [x] Touch interactions work smoothly on mobile devices
- [x] Accessibility standards maintained throughout implementation
- [x] Layout consistency across all three views (no padding gaps)
- [x] Scroll position saves and restores instantly when switching between views
- [x] Zero animation during scroll position restoration
- [x] Seamless scroll position persistence across all view switches using requestAnimationFrame
- [x] Clean, minimal filter interface without scroll indicators
- [x] Clean filter pill appearance without focus outlines
