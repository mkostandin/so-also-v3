# 0033_PLAN.md - Event Details Page UI Improvements

## Status: ✅ COMPLETED

## Brief Description
Reorganize the event details page layout to improve visual hierarchy and information flow. Move event type and committee tags above the separator directly below the title, and unify the description, date, and location components into a single cohesive component with consistent styling. Ensure address information is properly displayed in the location section with smart parsing for venue names, improve date/time formatting with ordinal suffixes and time ranges, and standardize typography across all elements for a clean, uniform appearance.

## Technical Requirements

### Phase 1: Layout Reorganization ✅ COMPLETED
**Files to Modify:**
- `ui/src/routes/EventDetail.tsx`
- `ui/src/components/EventTags.tsx`
- `ui/src/components/EventContent.tsx`

**Changes Implemented:**
1. **Move EventTags Component**: ✅ Relocated the `EventTags` component from its current position (line ~326) to within the header section, directly below the title but above the separator border.
2. **Update Header Layout**: ✅ Modified the header section in `EventDetail.tsx` to include the tags within the same container as the title, maintaining the existing border separator below both elements.
3. **Adjust Spacing**: ✅ Updated CSS classes to ensure proper spacing between title, tags, and separator.

### Phase 2: Unified Event Content Component ✅ COMPLETED
**Files to Modify:**
- `ui/src/components/EventContent.tsx`
- `ui/src/lib/session-utils.ts`
- `ui/src/routes/EventDetail.tsx`

**Changes Implemented:**
1. **Consolidate Components**: ✅ Merged the separate description, date, and location sections into a single unified component with consistent styling.
2. **Standardize Styling**: ✅ Replaced the current disparate styling (gray boxes for description/location, standalone large date text) with a unified design using consistent background colors, padding, and typography.
3. **Improve Date Display**: ✅ Integrated the date into the unified component with appropriate sizing that matches the overall design hierarchy.
4. **Enhance Location Section**: ✅ Ensured the location section properly displays address information alongside venue, city, and state. Verified that the `address` field from `EventItem` is being rendered correctly.
5. **Enhanced Date/Time Formatting**: ✅ Added new utility functions for improved date/time display:
   - `formatDateWithOrdinal()`: Formats dates with ordinal suffixes (e.g., "November 4th")
   - `formatTimeRange()`: Shows time ranges (e.g., "6:00 PM to 9:00 PM")
6. **Improved Visual Hierarchy**: ✅ Made date less prominent by reducing font size from `text-xl` to `text-base` and changing from `font-semibold` to `font-medium`
7. **Added Time Information**: ✅ Added time range display directly below the date with muted styling
8. **Consistent Typography**: ✅ Standardized all main content elements (date, time, venue, address, city/state) to use `text-base` with no bold styling for uniform appearance
9. **Smart Address Parsing**: ✅ Enhanced address display logic to properly handle comma-separated venue and street address information without incorrectly using event names
10. **Clean Venue Display**: ✅ Fixed venue logic to only use actual venue information from address data, not event titles

**Component Structure After Changes:**
```tsx
// Unified EventContent component structure
<div className="bg-gray-50 dark:bg-gray-800 rounded-lg p-4 space-y-6">
  {/* Description section */}
  <div>
    <p className="text-sm text-gray-600 dark:text-gray-300 leading-relaxed">{description}</p>
  </div>

  {/* Date and Time section */}
  <div>
    <p className="text-base text-gray-900 dark:text-white">{formattedDate}</p>
    <p className="text-base text-gray-700 dark:text-gray-300 mt-1">{timeRange}</p>
  </div>

  {/* Location section */}
  <div>
    <div className="space-y-1">
      {/* Smart parsing for venue and address */}
      <p className="text-base text-gray-900 dark:text-white">{venueName}</p>
      <p className="text-base text-gray-700 dark:text-gray-300">{streetAddress}</p>
      <p className="text-base text-gray-600 dark:text-gray-400">{cityState}</p>
      <p className="text-xs text-gray-500 dark:text-gray-500">{distance} miles away</p>
    </div>
  </div>
</div>
```

### Phase 3: Data Field Investigation ✅ COMPLETED
**Files to Review:**
- `ui/src/lib/api-client.ts`
- `server/src/schema/events.ts`

**Changes Implemented:**
1. **Verify Address Field**: ✅ Confirmed that the `address` field in `EventItem` type corresponds to the venue/street address as expected by the user.
2. **Check for Venue Field**: ✅ Investigated database schema and confirmed there is no separate `venue` field - the `address` field contains all venue/address information.
3. **Update Component Props**: ✅ Ensured `EventContent` component receives and properly displays all relevant location fields (`address`, `city`, `stateProv`, `distanceMeters`).
4. **Enhanced Null Handling**: ✅ Added proper null checking for `distanceMeters` to prevent runtime errors.

### Implementation Notes
- ✅ Maintain existing responsive design patterns and mobile optimizations
- ✅ Preserve accessibility features and ARIA labels
- ✅ Keep consistent with existing color scheme and component styling patterns
- ✅ Test changes across different event types and data availability scenarios
- ✅ Ensure proper error handling for missing data fields
- ✅ Added enhanced date/time formatting with ordinal suffixes
- ✅ Improved visual hierarchy by making date less prominent
- ✅ Added comprehensive time range display

### Testing Requirements ✅ COMPLETED
- ✅ Verify layout changes work on both desktop and mobile
- ✅ Test with events that have complete location data (venue, address, city, state)
- ✅ Test with events missing various location fields to ensure graceful degradation
- ✅ Confirm that event tags display correctly in new position
- ✅ Validate that unified content component maintains proper visual hierarchy
- ✅ Verify date formatting shows ordinal suffixes (e.g., "4th", "1st", "2nd", "3rd")
- ✅ Confirm time ranges display correctly (e.g., "6:00 PM to 9:00 PM")
- ✅ Test single time events display properly (e.g., "6:00 PM")

### Files Modified
- `ui/src/routes/EventDetail.tsx` - Moved EventTags to header, added endsAtUtc prop
- `ui/src/components/EventContent.tsx` - Unified component styling, added date/time formatting
- `ui/src/lib/session-utils.ts` - Added formatDateWithOrdinal and formatTimeRange functions

### Additional Improvements Beyond Original Plan
1. **Enhanced Date Formatting**: Added ordinal suffixes (1st, 2nd, 3rd, 4th, etc.) to date display
2. **Time Range Display**: Added comprehensive time information showing start and end times
3. **Improved Visual Hierarchy**: Made date less prominent to reduce visual clutter
4. **Better Null Handling**: Added proper null checking for distanceMeters field
5. **Component Optimization**: Removed unused formatDate parameter to clean up component interface
6. **Consistent Typography**: All main content elements now use uniform `text-base` sizing with no bold styling
7. **Smart Address Parsing**: Enhanced logic to properly separate venue names and street addresses from comma-delimited data
8. **Correct Venue Display**: Fixed logic to only use actual venue information, not event titles
9. **Unified Visual Design**: Created consistent styling hierarchy using color instead of size/weight variations
