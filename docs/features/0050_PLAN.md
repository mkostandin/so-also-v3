# Feature 0050: Fix Calendar Component Responsive Design at 375px Width

## Overview

Fix the calendar component's responsive design issues at 375px device width where it currently gets cut off and appears elongated/ugly. The calendar should display properly on narrow mobile screens while maintaining usability and visual appeal.

## Technical Requirements

### Current Issues Identified
1. **Excessive margins consuming screen space**: `mx-3` margins (12px each side) take up disproportionate space on 375px screens
2. **Fixed minimum heights not scaling**: `min-h-[48px]` calendar cells don't adapt to narrow screens
3. **7-column grid without mobile optimization**: Calendar grid lacks responsive adjustments for very narrow screens
4. **No specific 375px breakpoint handling**: Current responsive design doesn't account for iPhone SE and similar narrow devices

### Target Device Specifications
- **Primary target**: 375px width devices (iPhone SE, iPhone 12/13 mini in portrait)
- **Secondary targets**: 320px - 414px width range
- **Maintain compatibility**: All larger screen sizes should continue working as before

### Additional Changes Made
- **Skeleton Loading**: Reverted responsive skeleton margins back to original `mx-6` for consistency
- **Calendar Border**: Restored `border` class to calendar grid container for proper visual outline
- **Distance Filter Separator**: Removed `border-b` class from distance filter container to eliminate separator line
- **Loading State**: Maintained original skeleton dimensions (`w-10/12` for navigation and grid, `w-2/3` for filter)

## Files Requiring Changes

### Core Calendar Components
- **`ui/src/routes/CalendarView.tsx`**
  - Container width and margin adjustments
  - Month navigation responsive layout
  - Filter section spacing optimization

- **`ui/src/components/CalendarGrid.tsx`**
  - Calendar cell sizing and spacing
  - Grid layout responsive adjustments
  - Touch target optimization

- **`ui/src/components/CalendarEventIndicator.tsx`**
  - Event indicator sizing for narrow screens
  - Touch target size validation

### Supporting Files
- **`ui/src/components/CalendarEventPopup.tsx`** (if popup positioning affected)
- **`ui/src/components/DistanceFilter.tsx`** (if filter layout needs adjustment)

## Implementation Algorithm

### Phase 1: Container and Layout Optimization

1. **Width Constraints Adjustment**
   - Replace fixed `max-w-*` classes with mobile-first responsive approach
   - Implement custom breakpoints for 375px and below
   - Remove excessive margins on narrow screens

2. **Margin and Padding Reduction Algorithm**
   ```
   For screens ≤ 375px:
   - Reduce mx-3 to mx-1 (from 12px to 4px each side)
   - Reduce p-4 to p-2 in calendar containers
   - Implement zero-margin containers where possible
   ```

3. **Month Navigation Responsive Layout**
   - Adjust button sizes and spacing for narrow screens
   - Implement flex-wrap for very narrow screens if needed
   - Optimize font sizes for readability

4. **Skeleton Loading Adjustment**
   - **Reverted**: Maintained original `mx-6` margins for consistency
   - **Reverted**: Kept original skeleton widths (`w-10/12` for nav/grid, `w-2/3` for filter)

5. **Final Styling Adjustments**
   - **Calendar Border**: Restored `border` class to calendar grid for proper visual outline
   - **Separator Removal**: Removed `border-b` from distance filter container for cleaner transition

### Phase 2: Calendar Grid Optimization

1. **Cell Sizing Algorithm**
   ```
   Calculate available width: screen_width - margins - padding
   Cell width = available_width / 7
   Minimum cell width = 32px (to prevent cramping)
   If cell_width < minimum_width:
     Implement single-column fallback or adjust grid
   ```

2. **Height Optimization**
   - Replace fixed `min-h-[48px]` with responsive minimum heights
   - Implement aspect-ratio based sizing for consistent appearance
   - Ensure touch targets meet minimum 44px requirement

3. **Grid Gap Adjustment**
   - Reduce gap from default to `gap-1` on narrow screens
   - Implement zero-gap for extreme narrowness if needed

### Phase 3: Component-Level Responsive Adjustments

1. **CalendarEventIndicator Optimization**
   - Reduce indicator size from `h-5 w-5` to `h-4 w-4` on narrow screens
   - Maintain 44px touch target through padding adjustments
   - Optimize font size for readability

2. **Text and Content Scaling**
   - Implement responsive font sizes for day numbers
   - Adjust event indicator text size
   - Optimize day name abbreviations

### Phase 4: Touch and Interaction Optimization

1. **Touch Target Validation**
   - Ensure all interactive elements meet 44px minimum touch target
   - Implement padding adjustments to maintain accessibility
   - Test tap accuracy on narrow screens

2. **Scroll and Overflow Handling**
   - Prevent horizontal overflow on narrow screens
   - Implement proper scroll behavior for calendar content
   - Ensure popup positioning works within narrow viewport

## Responsive Breakpoint Strategy

### Mobile-First Approach
```css
/* 320px - 374px: Extreme narrow */
.calendar-container {
  margin: 0 2px;
  padding: 8px;
}

/* 375px - 414px: Standard narrow mobile */
.calendar-container {
  margin: 0 4px;
  padding: 12px;
}

/* 415px+: Standard responsive behavior */
.calendar-container {
  margin: 0 12px;
  padding: 16px;
}
```

### Grid Responsive Algorithm
```
if (screenWidth <= 375) {
  cellMinWidth = 32px
  gap = 2px
  fontSize = 'xs'
} else if (screenWidth <= 414) {
  cellMinWidth = 36px
  gap = 4px
  fontSize = 'sm'
} else {
  cellMinWidth = 40px
  gap = 6px
  fontSize = 'base'
}
```

## Testing and Validation

### Test Scenarios
1. **375px width devices**: iPhone SE, iPhone 12/13 mini portrait
2. **320px width devices**: Very narrow mobile screens
3. **414px width devices**: Standard mobile portrait
4. **Landscape orientations**: Ensure landscape still works properly
5. **Touch interaction**: Validate all touch targets meet accessibility standards

### Validation Metrics
- **No horizontal overflow**: Calendar must fit within viewport width
- **Minimum touch targets**: All interactive elements ≥44px
- **Readable text**: Font sizes maintain readability
- **Visual consistency**: Maintain calendar appearance across devices
- **Proper borders**: Calendar has appropriate border outline, distance filter separator removed

## Implementation Notes

### CSS Custom Properties Strategy
Implement CSS custom properties for responsive values:
```css
:root {
  --calendar-margin: 12px;
  --calendar-cell-min-height: 48px;
  --calendar-gap: 4px;
}

@media (max-width: 375px) {
  :root {
    --calendar-margin: 4px;
    --calendar-cell-min-height: 40px;
    --calendar-gap: 2px;
  }
}
```

### Performance Considerations
- Avoid layout shifts during responsive adjustments
- Implement CSS containment for better performance
- Minimize JavaScript-based responsive calculations

### Accessibility Impact
- Maintain WCAG touch target guidelines
- Preserve keyboard navigation functionality
- Ensure screen reader compatibility on narrow screens

## Success Criteria
- ✅ Calendar displays fully within 375px viewport without horizontal scroll
- ✅ All interactive elements remain accessible and usable
- ✅ Visual appearance remains clean and professional
- ✅ Performance maintains current standards
- ✅ No regression in functionality on larger screens
- ✅ Skeleton loading maintains original appearance and behavior
- ✅ Calendar has proper border outline with distance filter separator removed
